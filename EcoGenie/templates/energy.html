<!DOCTYPE html>
<html>
<head>
    <title>Energy Consumption Information</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
    <script>
        function updateEnergyForm() {
            let heatingType = document.getElementById("heating_type").value;
            
            // Hide gas usage field unless heating type is "gas"
            document.getElementById("gas_usage_section").style.display = (heatingType === "gas") ? "block" : "none";
        }

        function validateForm(event) {
            let valid = true;
            let errors = [];

            // Get values
            let electricityUsage = document.getElementById("electricity_kwh_per_month").value;
            let gasUsage = document.getElementById("gas_usage_cubic_meters")?.value;

            // Validation checks
            if (electricityUsage < 0) {
                errors.push("Electricity usage cannot be negative.");
            }
            if (gasUsage && gasUsage < 0) {
                errors.push("Gas usage cannot be negative.");
            }

            // Display errors if any
            let errorBox = document.getElementById("error_messages");
            errorBox.innerHTML = "";
            if (errors.length > 0) {
                event.preventDefault();  // Prevent form submission
                errorBox.innerHTML = "<ul><li>" + errors.join("</li><li>") + "</li></ul>";
            }
        }
    </script>
</head>
<body onload="updateEnergyForm()">
    <h1>Enter Your Energy Consumption Details</h1>

    <div id="error_messages" style="color: red;"></div> <!-- Error messages appear here -->

    <form method="POST" onsubmit="validateForm(event)">
        <label title="How many kilowatt-hours (kWh) of electricity do you use per month?">Electricity Usage (kWh/month):</label>
        <input type="number" id="electricity_kwh_per_month" name="electricity_kwh_per_month" step="0.1" placeholder="e.g., 350"><br>

        <label title="Is your electricity sourced from renewable energy?">Electricity Source:</label>
        <select name="electricity_source">
            <option value="yes">Yes (100% Renewable)</option>
            <option value="no">No (Non-Renewable)</option>
            <option value="some">Some (Mixed Energy Source)</option>
        </select><br>

        <label title="What type of heating system do you use in your home?">Heating Type:</label>
        <select name="heating_type" id="heating_type" onchange="updateEnergyForm()">
            <option value="gas">Gas</option>
            <option value="electric">Electric</option>
            <option value="oil">Oil</option>
            <option value="none">None</option>
        </select><br>

        <div id="gas_usage_section" style="display: none;">
            <label title="How many cubic meters of gas do you use per month?">Gas Usage (mÂ³/month):</label>
            <input type="number" id="gas_usage_cubic_meters" name="gas_usage_cubic_meters" step="0.1" placeholder="e.g., 50"><br>
        </div>

        <label title="Do you use energy-efficient appliances at home?">Energy-Efficient Appliances:</label>
        <select name="energy_efficient_appliances">
            <option value="yes">Yes</option>
            <option value="no">No</option>
            <option value="some">Some</option>
        </select><br>

        <button type="submit">Next</button>
    </form>
</body>
</html>
